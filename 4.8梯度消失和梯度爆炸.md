```python
%matplotlib inline
import torch
from d2l import torch as d2l
```


```python
#梯度消失
x = torch.arange(-8.0,8.0,0.1,requires_grad=True)
y = torch.sigmoid(x)
y.backward(torch.ones_like(x))

d2l.plot(x.detach().numpy(),[y.detach().numpy(),x.grad.numpy()],
         legend=['sigmoid','gradient'],figsize=(4.5,2.5))

```


    
![svg](output_1_0.svg)
    



```python
#梯度爆炸
M = torch.normal(0,1,size=(4,4))
print('一个矩阵\n',M)
for i in range(100):
    M = torch.mm(M,torch.normal(0,1,size=(4,4)))
print('乘以100个矩阵后\n',M)
```

    一个矩阵
     tensor([[-0.0904, -0.8892,  1.1787, -1.6691],
            [ 0.0701, -0.1763, -1.5559, -0.0487],
            [-0.9666,  0.2624,  0.5617,  0.5673],
            [-1.4071,  0.1311,  0.3636, -0.5491]])
    乘以100个矩阵后
     tensor([[-2.2364e+25, -1.0368e+25, -2.1185e+24, -7.9592e+24],
            [ 3.1758e+25,  1.4723e+25,  3.0084e+24,  1.1302e+25],
            [ 1.1572e+25,  5.3648e+24,  1.0962e+24,  4.1184e+24],
            [ 2.4872e+25,  1.1531e+25,  2.3561e+24,  8.8517e+24]])
    


```python

```
